{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Roua/Desktop/IDS/components/navbar.tsx"],"sourcesContent":["\"use client\"\n\nimport Link from \"next/link\"\nimport { usePathname } from \"next/navigation\"\nimport { Shield } from \"lucide-react\"\n\nexport function Navbar() {\n  const pathname = usePathname()\n\n  const navItems = [\n    { href: \"/\", label: \"Home\" },\n    { href: \"/dashboard\", label: \"Live Monitor\" },\n    { href: \"/analysis\", label: \"Analysis\" },\n    { href: \"/about\", label: \"About\" },\n  ]\n\n  return (\n    <nav className=\"bg-card border-b border-border sticky top-0 z-50\">\n      <div className=\"max-w-7xl mx-auto px-6 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <Link href=\"/\" className=\"flex items-center gap-2 font-bold text-xl text-primary hover:opacity-80 transition\">\n            <Shield className=\"w-7 h-7\" />\n            <span>IDS</span>\n          </Link>\n\n          <div className=\"flex items-center gap-8\">\n            {navItems.map((item) => (\n              <Link\n                key={item.href}\n                href={item.href}\n                className={`font-medium transition ${\n                  pathname === item.href\n                    ? \"text-primary border-b-2 border-primary pb-1\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                {item.label}\n              </Link>\n            ))}\n          </div>\n        </div>\n      </div>\n    </nav>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMO,SAAS;IACd,MAAM,WAAW,IAAA,iJAAW;IAE5B,MAAM,WAAW;QACf;YAAE,MAAM;YAAK,OAAO;QAAO;QAC3B;YAAE,MAAM;YAAc,OAAO;QAAe;QAC5C;YAAE,MAAM;YAAa,OAAO;QAAW;QACvC;YAAE,MAAM;YAAU,OAAO;QAAQ;KAClC;IAED,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,uKAAI;wBAAC,MAAK;wBAAI,WAAU;;0CACvB,8OAAC,gNAAM;gCAAC,WAAU;;;;;;0CAClB,8OAAC;0CAAK;;;;;;;;;;;;kCAGR,8OAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC,qBACb,8OAAC,uKAAI;gCAEH,MAAM,KAAK,IAAI;gCACf,WAAW,CAAC,uBAAuB,EACjC,aAAa,KAAK,IAAI,GAClB,gDACA,+CACJ;0CAED,KAAK,KAAK;+BARN,KAAK,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;AAgB9B"}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Roua/Desktop/IDS/app/analysis/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { Navbar } from \"@/components/navbar\"\nimport { Zap, AlertCircle } from \"lucide-react\"\n\ninterface DetectionResult {\n  Level1: string\n  Level2: string\n  Level3: string\n  Status: string\n}\n\nexport default function Analysis() {\n  const [index, setIndex] = useState<number>(540822)\n  const [results, setResults] = useState<DetectionResult | null>(null)\n  const [loading, setLoading] = useState(false)\n  const [datasetSize, setDatasetSize] = useState<number | null>(null)\n  const [error, setError] = useState<string | null>(null)\n\n  const API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:5000\"\n\n  const handleAnalyze = async () => {\n    try {\n      setLoading(true)\n      setError(null)\n\n      const response = await fetch(`${API_URL}/api/detect-by-index`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ index }),\n      })\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        throw new Error(errorData.error || \"Analysis failed\")\n      }\n\n      const data = await response.json()\n      setResults(data.result)\n      setDatasetSize(data.dataset_size)\n      console.log(\"[v0] Analysis completed for index\", index, data.result)\n    } catch (err) {\n      const message = err instanceof Error ? err.message : \"Unknown error\"\n      setError(message)\n      console.error(\"[v0] Analysis error:\", message)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleRandomAttack = async () => {\n    try {\n      const randomIdx = Math.floor(Math.random() * (1000000 - 540814) + 540814)\n      setIndex(randomIdx)\n      setError(null)\n\n      // Analyze the random index\n      const response = await fetch(`${API_URL}/api/detect-by-index`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ index: randomIdx }),\n      })\n\n      if (!response.ok) throw new Error(\"Failed to analyze\")\n\n      const data = await response.json()\n      setResults(data.result)\n      setDatasetSize(data.dataset_size)\n    } catch (err) {\n      console.error(\"[v0] Random attack error:\", err)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"px-6 py-8 max-w-4xl mx-auto\">\n        <h1 className=\"text-4xl font-bold text-foreground mb-2\">Manual Analysis</h1>\n        <p className=\"text-muted-foreground mb-8\">Analyze network flows with detailed threat classification</p>\n\n        <div className=\"bg-card border border-border rounded-lg p-8\">\n          <div className=\"mb-6\">\n            <label className=\"block text-foreground font-semibold mb-4\">Upload Network Data (CSV)</label>\n            <input\n              type=\"file\"\n              accept=\".csv\"\n              className=\"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground cursor-pointer file:mr-4 file:bg-primary file:text-primary-foreground file:px-4 file:py-2 file:border-0 file:rounded-md file:cursor-pointer\"\n            />\n          </div>\n\n          <div className=\"space-y-4 mb-6\">\n            <div>\n              <label className=\"block text-foreground font-semibold mb-4\">Flow Index (Dataset)</label>\n              <p className=\"text-muted-foreground text-sm mb-3\">\n                {datasetSize ? `Dataset contains ${datasetSize.toLocaleString()} flows` : \"Loading dataset info...\"}\n              </p>\n              <p className=\"text-muted-foreground text-sm mb-2\">Benign flows: 0-540,813 | Attack flows: 540,814+</p>\n              <input\n                type=\"number\"\n                value={index}\n                onChange={(e) => setIndex(Math.max(0, Number.parseInt(e.target.value) || 0))}\n                className=\"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground\"\n                min=\"0\"\n                max={datasetSize ? datasetSize - 1 : undefined}\n              />\n            </div>\n          </div>\n\n          <div className=\"flex gap-3 mb-6\">\n            <button\n              onClick={handleAnalyze}\n              disabled={loading}\n              className=\"flex-1 bg-primary hover:opacity-90 disabled:opacity-50 text-primary-foreground font-semibold py-3 rounded-lg transition flex items-center justify-center gap-2\"\n            >\n              <Zap className=\"w-4 h-4\" />\n              {loading ? \"Analyzing...\" : \"Run Analysis\"}\n            </button>\n            <button\n              onClick={handleRandomAttack}\n              disabled={loading}\n              className=\"flex-1 bg-secondary hover:opacity-90 disabled:opacity-50 text-secondary-foreground font-semibold py-3 rounded-lg transition\"\n            >\n              ðŸŽ² Random Attack\n            </button>\n          </div>\n\n          {error && (\n            <div className=\"mb-6 bg-destructive/10 border border-destructive rounded-lg p-4 flex gap-3\">\n              <AlertCircle className=\"w-5 h-5 text-destructive flex-shrink-0 mt-0.5\" />\n              <p className=\"text-destructive\">{error}</p>\n            </div>\n          )}\n\n          {results && (\n            <div>\n              <h3 className=\"text-xl font-bold text-foreground mb-4\">Detection Results</h3>\n              <div className=\"bg-background border border-border rounded p-6 grid md:grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"text-muted-foreground text-sm uppercase\">Level 1 (Binary)</p>\n                  <p className=\"text-foreground font-bold text-lg\">{results.Level1}</p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground text-sm uppercase\">Level 2 (Family)</p>\n                  <p className=\"text-foreground font-bold text-lg\">{results.Level2}</p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground text-sm uppercase\">Level 3 (Type)</p>\n                  <p className=\"text-foreground font-bold text-lg\">{results.Level3}</p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground text-sm uppercase\">Status</p>\n                  <p\n                    className={`font-bold text-lg ${results.Status === \"Danger\" ? \"text-destructive\" : \"text-chart-2\"}`}\n                  >\n                    {results.Status}\n                  </p>\n                </div>\n              </div>\n\n              {results.Status === \"Danger\" && (\n                <div className=\"mt-4 bg-destructive/10 border border-destructive rounded-lg p-4\">\n                  <p className=\"text-destructive font-semibold\">ðŸš¨ Malicious Traffic Detected: {results.Level3}</p>\n                </div>\n              )}\n\n              {results.Status === \"Safe\" && (\n                <div className=\"mt-4 bg-chart-2/10 border border-chart-2 rounded-lg p-4\">\n                  <p className=\"text-chart-2 font-semibold\">âœ… Traffic is Benign</p>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}